{
	"info": {
		"_postman_id": "recommendation-api-001",
		"name": "سیستم توصیه محصولات - Recommendation API",
		"description": "مجموعه کامل endpointهای API سیستم توصیه محصولات\n\n**راه‌اندازی:**\n1. راه‌اندازی API: `python run_recommendation.py api --host 0.0.0.0 --port 8000`\n2. یا: `uvicorn recommendation_api:app --host 0.0.0.0 --port 8000`\n\n**مستندات:**\n- Swagger UI: http://localhost:8000/docs\n- این مجموعه: شامل تمام endpointها با مثال‌ها\n\n**متغیرها:**\n- `base_url`: آدرس پایه API (پیش‌فرض: http://localhost:8000)\n- `user_id`: شناسه کاربر نمونه (پیش‌فرض: 9194445)\n- `product_id`: شناسه محصول نمونه (پیش‌فرض: 501838)",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "recommendation-api"
	},
	"item": [
		{
			"name": "اطلاعات عمومی",
			"item": [
				{
					"name": "صفحه اصلی - Root",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								""
							]
						},
						"description": "صفحه اصلی API - اطلاعات کلی سیستم"
					},
					"response": [
						{
							"name": "Success Response",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/",
									"host": [
										"{{base_url}}"
									],
									"path": [
										""
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"message\": \"سیستم توصیه محصولات\",\n    \"version\": \"1.0.0\",\n    \"status\": \"active\"\n}"
						}
					]
				},
				{
					"name": "بررسی سلامت - Health Check",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/health",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"health"
							]
						},
						"description": "بررسی سلامت سیستم و وضعیت API\n\n**استفاده:**\n- Monitoring و Alerting\n- بررسی اینکه API در حال اجرا است\n- کنترل سلامت کلی"
					},
					"response": [
						{
							"name": "Healthy System",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/health",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"health"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"status\": \"healthy\",\n    \"recommender_ready\": false,\n    \"products_loaded\": 36114\n}"
						}
					]
				},
				{
					"name": "آمار سیستم - System Stats",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/stats",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"stats"
							]
						},
						"description": "دریافت آمار کلی سیستم شامل:\n- تعداد کل محصولات\n- وضعیت recommender\n- اتصال Redis\n- آمار Redis (حجم حافظه، تعداد توصیه‌ها)\n- آمار DuckDB (تعداد توصیه‌های ذخیره شده)"
					},
					"response": [
						{
							"name": "Stats Response",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/stats",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"stats"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"total_products\": 36114,\n    \"recommender_ready\": false,\n    \"redis_connected\": true,\n    \"redis_stats\": {\n        \"total_recommendations\": 3,\n        \"memory_usage_mb\": 80.27\n    },\n    \"duckdb_stats\": {\n        \"total_users_with_recommendations\": 1500,\n        \"total_recommendations\": 30000\n    }\n}"
						}
					]
				}
			],
			"description": "Endpointهای عمومی برای اطلاعات و بررسی وضعیت سیستم"
		},
		{
			"name": "توصیه‌ها - Recommendations",
			"item": [
				{
					"name": "دریافت توصیه‌های کاربر",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/recommendations/{{user_id}}?limit=10&use_redis=true&use_duckdb=true",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"recommendations",
								"{{user_id}}"
							],
							"query": [
								{
									"key": "limit",
									"value": "10",
									"description": "تعداد توصیه‌ها (پیش‌فرض: 10)"
								},
								{
									"key": "use_redis",
									"value": "true",
									"description": "استفاده از Redis برای خواندن سریع (پیش‌فرض: true)"
								},
								{
									"key": "use_duckdb",
									"value": "true",
									"description": "استفاده از DuckDB برای خواندن persistent (پیش‌فرض: true)"
								}
							]
						},
						"description": "**این endpoint اصلی API شماست!**\n\nدریافت توصیه‌های محصولات برای یک کاربر خاص\n\n**پارامترها:**\n- `user_id` (path): شناسه کاربر (required)\n- `limit` (query): تعداد توصیه‌ها (default: 10)\n- `use_redis` (query): استفاده از Redis برای خواندن سریع (default: true)\n- `use_duckdb` (query): استفاده از DuckDB برای خواندن persistent (default: true)\n\n**ترتیب بررسی:**\n1. Redis (cache) - سریع‌ترین (< 1ms)\n2. DuckDB (persistent) - اگر Redis در دسترس نباشد (~50-100ms)\n3. تولید مستقیم (fallback) - اگر هیچکدام در دسترس نباشد\n\n**پاسخ شامل:**\n- `product_id`: شناسه محصول\n- `score`: امتیاز توصیه\n- `reason`: دلیل توصیه\n- `confidence`: میزان اطمینان\n- `product_title`: عنوان محصول\n- `product_price`: قیمت محصول\n- `product_stock`: موجودی\n- `collaborative_details`: جزئیات collaborative filtering"
					},
					"response": [
						{
							"name": "Success with Redis",
							"originalRequest": {
								"method": "GET",
								"header": [],
							"url": {
								"raw": "{{base_url}}/recommendations/{{user_id}}?limit=10&use_redis=true&use_duckdb=true",
								"host": [
									"{{base_url}}"
								],
								"path": [
									"recommendations",
									"{{user_id}}"
								],
								"query": [
									{
										"key": "limit",
										"value": "10"
									},
									{
										"key": "use_redis",
										"value": "true"
									},
									{
										"key": "use_duckdb",
										"value": "true"
									}
								]
							}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "[\n    {\n        \"product_id\": 501838,\n        \"score\": 1587.0,\n        \"confidence\": 1.0,\n        \"reason\": \"Collaborative: 1 کاربران مشابه این محصول را خریده‌اند\",\n        \"product_title\": null,\n        \"product_price\": null,\n        \"product_stock\": null,\n        \"collaborative_details\": {\n            \"similar_users\": [\n                {\n                    \"user_id\": 9391201,\n                    \"similarity\": 0.0009,\n                    \"similarity_percent\": 0.09\n                }\n            ],\n            \"total_similar_users\": 1\n        }\n    },\n    {\n        \"product_id\": 12345,\n        \"score\": 1500.0,\n        \"confidence\": 0.95,\n        \"reason\": \"Content-based: مشابه محصولات قبلی شما\",\n        \"product_title\": \"محصول نمونه\",\n        \"product_price\": 100000.0,\n        \"product_stock\": 50\n    }\n]"
						},
						{
							"name": "Service Unavailable (503)",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/recommendations/{{user_id}}",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"recommendations",
										"{{user_id}}"
									]
								}
							},
							"status": "Service Unavailable",
							"code": 503,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"detail\": \"توصیه‌ای برای این کاربر یافت نشد و سیستم در حال بارگذاری است\"\n}"
						}
					]
				},
				{
					"name": "دریافت 5 توصیه اول",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/recommendations/{{user_id}}?limit=5",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"recommendations",
								"{{user_id}}"
							],
							"query": [
								{
									"key": "limit",
									"value": "5",
									"description": "تعداد توصیه‌ها"
								}
							]
						},
						"description": "مثال: دریافت 5 توصیه اول برای کاربر"
					},
					"response": []
				},
				{
					"name": "بدون Redis (Fallback)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/recommendations/{{user_id}}?use_redis=false",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"recommendations",
								"{{user_id}}"
							],
							"query": [
								{
									"key": "use_redis",
									"value": "false",
									"description": "استفاده از fallback به جای Redis"
								}
							]
						},
						"description": "مثال: دریافت توصیه‌ها بدون استفاده از Redis (fallback mode)"
					},
					"response": []
				}
			],
			"description": "Endpointهای مربوط به دریافت توصیه‌های محصولات برای کاربران"
		},
		{
			"name": "بینش کاربر - User Insights",
			"item": [
				{
					"name": "دریافت بینش‌های کاربر",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/insights/{{user_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"insights",
								"{{user_id}}"
							]
						},
						"description": "دریافت بینش‌ها و آمار مربوط به کاربر\n\n**اطلاعات برگشتی:**\n- `total_interactions`: تعداد کل تعاملات کاربر\n- `preferred_categories`: دسته‌بندی‌های مورد علاقه\n- `average_purchase_value`: میانگین ارزش خرید\n- `similar_users`: کاربران مشابه"
					},
					"response": [
						{
							"name": "User Insights",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/insights/{{user_id}}",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"insights",
										"{{user_id}}"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"total_interactions\": 10,\n    \"preferred_categories\": [\n        [\"دسته‌بندی 1\", 5],\n        [\"دسته‌بندی 2\", 3]\n    ],\n    \"average_purchase_value\": 150000.0,\n    \"similar_users\": [\n        [9391201, 0.0009],\n        [1234567, 0.0008]\n    ]\n}"
						}
					]
				}
			],
			"description": "Endpointهای مربوط به بینش‌ها و آمار کاربران"
		},
		{
			"name": "محصولات - Products",
			"item": [
				{
					"name": "محصولات محبوب - Popular Products",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/popular?limit=10",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"popular"
							],
							"query": [
								{
									"key": "limit",
									"value": "10",
									"description": "تعداد محصولات (پیش‌فرض: 10)"
								}
							]
						},
						"description": "دریافت لیست محصولات محبوب بر اساس تعداد خرید\n\n**پارامترها:**\n- `limit` (query): تعداد محصولات (default: 10)\n\n**پاسخ شامل:**\n- `product_id`: شناسه محصول\n- `purchase_count`: تعداد خرید\n- `product_title`: عنوان محصول\n- `product_price`: قیمت محصول"
					},
					"response": [
						{
							"name": "Popular Products",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/popular?limit=10",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"popular"
									],
									"query": [
										{
											"key": "limit",
											"value": "10"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "[\n    {\n        \"product_id\": 12345,\n        \"purchase_count\": 150,\n        \"product_title\": \"محصول نمونه\",\n        \"product_price\": 100000.0\n    },\n    {\n        \"product_id\": 67890,\n        \"purchase_count\": 120,\n        \"product_title\": \"محصول دیگر\",\n        \"product_price\": 95000.0\n    }\n]"
						}
					]
				},
				{
					"name": "محصولات مشابه - Similar Products",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/similar/{{product_id}}?limit=5",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"similar",
								"{{product_id}}"
							],
							"query": [
								{
									"key": "limit",
									"value": "5",
									"description": "تعداد محصولات مشابه (پیش‌فرض: 5)"
								}
							]
						},
						"description": "دریافت محصولات مشابه به یک محصول خاص\n\n**پارامترها:**\n- `product_id` (path): شناسه محصول (required)\n- `limit` (query): تعداد محصولات مشابه (default: 5)\n\n**پاسخ شامل:**\n- `product_id`: شناسه محصول\n- `similarity_score`: امتیاز شباهت (0 تا 1)\n- `product_title`: عنوان محصول\n- `product_price`: قیمت محصول"
					},
					"response": [
						{
							"name": "Similar Products",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/similar/{{product_id}}?limit=5",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"similar",
										"{{product_id}}"
									],
									"query": [
										{
											"key": "limit",
											"value": "5"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "[\n    {\n        \"product_id\": 67890,\n        \"similarity_score\": 0.85,\n        \"product_title\": \"محصول مشابه\",\n        \"product_price\": 95000.0\n    },\n    {\n        \"product_id\": 11111,\n        \"similarity_score\": 0.78,\n        \"product_title\": \"محصول دیگر\",\n        \"product_price\": 88000.0\n    }\n]"
						}
					]
				}
			],
			"description": "Endpointهای مربوط به محصولات (محبوب و مشابه)"
		},
		{
			"name": "مدیریت مدل - Model Management",
			"item": [
				{
					"name": "بازآموزی مدل - Retrain Model",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/retrain",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"retrain"
							]
						},
						"description": "بازآموزی کامل مدل سیستم توصیه\n\n**⚠️ هشدار:**\n- این عملیات می‌تواند 10-45 دقیقه طول بکشد!\n- در حین بازآموزی، سیستم ممکن است کند عمل کند\n- بهتر است این عملیات در ساعات کم‌ترافیک انجام شود\n\n**عملکرد:**\n1. آموزش مجدد HybridRecommender\n2. به‌روزرسانی کش محصولات\n3. بازگشت آمار محصولات بارگذاری شده"
					},
					"response": [
						{
							"name": "Retrain Success",
							"originalRequest": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{base_url}}/retrain",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"retrain"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"message\": \"مدل با موفقیت بازآموزی شد\",\n    \"products_count\": 36114\n}"
						},
						{
							"name": "Internal Server Error",
							"originalRequest": {
								"method": "POST",
								"header": [],
								"url": {
									"raw": "{{base_url}}/retrain",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"retrain"
									]
								}
							},
							"status": "Internal Server Error",
							"code": 500,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"detail\": \"خطا در بازآموزی مدل: [پیام خطا]\n}"
						}
					]
				}
			],
			"description": "Endpointهای مربوط به مدیریت و به‌روزرسانی مدل"
		},
		{
			"name": "تولید توصیه‌ها - Generate Recommendations",
			"item": [
				{
					"name": "تولید توصیه برای کاربران",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"user_ids\": [9194445, 1234567, 9876543],\n    \"top_k\": 20\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/generate-recommendations",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"generate-recommendations"
							]
						},
						"description": "تولید توصیه برای کاربران مشخص در پس‌زمینه\n\n**⚠️ توجه:**\n- این عملیات در پس‌زمینه اجرا می‌شود\n- فوراً job_id برمی‌گرداند\n- برای بررسی وضعیت از `/job-status/{job_id}` استفاده کنید\n\n**پارامترها:**\n- `user_ids` (required): لیست شناسه کاربران\n- `top_k` (optional): تعداد توصیه برای هر کاربر (default: 20, max: 100)\n\n**پاسخ:**\n- `job_id`: شناسه job برای پیگیری\n- `status`: وضعیت (pending, running, completed, failed)\n- `message`: پیام وضعیت\n- `created_at`: زمان ایجاد"
					},
					"response": [
						{
							"name": "Job Created",
							"originalRequest": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"user_ids\": [9194445, 1234567],\n    \"top_k\": 20\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{base_url}}/generate-recommendations",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"generate-recommendations"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"job_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"status\": \"pending\",\n    \"message\": \"درخواست ثبت شد و در حال پردازش است\",\n    \"created_at\": \"2024-01-15T10:30:00\",\n    \"total_users\": 2\n}"
						}
					]
				},
				{
					"name": "بررسی وضعیت Job",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/job-status/{{job_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"job-status",
								"{{job_id}}"
							]
						},
						"description": "بررسی وضعیت job تولید توصیه\n\n**پارامترها:**\n- `job_id` (path): شناسه job از endpoint `/generate-recommendations`\n\n**وضعیت‌های ممکن:**\n- `pending`: در انتظار شروع\n- `running`: در حال اجرا\n- `completed`: تکمیل شده\n- `failed`: خطا در اجرا\n\n**اطلاعات برگشتی:**\n- `status`: وضعیت فعلی\n- `processed_users`: تعداد کاربران پردازش شده\n- `total_users`: تعداد کل کاربران\n- `error`: پیام خطا (در صورت وجود)"
					},
					"response": [
						{
							"name": "Job Running",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/job-status/550e8400-e29b-41d4-a716-446655440000",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"job-status",
										"550e8400-e29b-41d4-a716-446655440000"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"job_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"status\": \"running\",\n    \"message\": \"در حال پردازش...\",\n    \"created_at\": \"2024-01-15T10:30:00\",\n    \"started_at\": \"2024-01-15T10:30:05\",\n    \"total_users\": 2,\n    \"processed_users\": 1,\n    \"failed_users\": 0\n}"
						},
						{
							"name": "Job Completed",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/job-status/550e8400-e29b-41d4-a716-446655440000",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"job-status",
										"550e8400-e29b-41d4-a716-446655440000"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"job_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"status\": \"completed\",\n    \"message\": \"توصیه‌ها با موفقیت برای 2 کاربر تولید شد\",\n    \"created_at\": \"2024-01-15T10:30:00\",\n    \"started_at\": \"2024-01-15T10:30:05\",\n    \"completed_at\": \"2024-01-15T10:35:20\",\n    \"total_users\": 2,\n    \"processed_users\": 2,\n    \"failed_users\": 0\n}"
						}
					]
				},
				{
					"name": "لیست Job ها",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/jobs?limit=10",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"jobs"
							],
							"query": [
								{
									"key": "limit",
									"value": "10",
									"description": "تعداد job ها (پیش‌فرض: 10)"
								}
							]
						},
						"description": "دریافت لیست آخرین job ها\n\n**پارامترها:**\n- `limit` (query): تعداد job ها (default: 10)\n\n**نکته:**\nJob ها بر اساس زمان ایجاد مرتب می‌شوند (جدیدترین اول)"
					},
					"response": []
				},
				{
					"name": "حذف Job",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{base_url}}/job/{{job_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"job",
								"{{job_id}}"
							]
						},
						"description": "حذف job (فقط job های completed یا failed)\n\n**⚠️ توجه:**\n- فقط job های `completed` یا `failed` قابل حذف هستند\n- job های `running` یا `pending` قابل حذف نیستند"
					},
					"response": []
				}
			],
			"description": "Endpointهای مربوط به تولید توصیه‌ها در پس‌زمینه و مدیریت Job ها"
		},
		{
			"name": "کاربران بدون توصیه - Users Without Recommendations",
			"item": [
				{
					"name": "لیست کاربران بدون توصیه",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/users-without-recommendations?limit=100&check_all=false",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users-without-recommendations"
							],
							"query": [
								{
									"key": "limit",
									"value": "100",
									"description": "محدود کردن تعداد کاربران برای بررسی (None = همه)"
								},
								{
									"key": "check_all",
									"value": "false",
									"description": "اگر true باشد، همه کاربران را بررسی می‌کند (ممکن است کند باشد)"
								}
							]
						},
						"description": "دریافت لیست کاربرانی که توصیه برایشان ایجاد نشده است\n\n**پارامترها:**\n- `limit` (query): محدود کردن تعداد کاربران (optional)\n- `check_all` (query): بررسی همه کاربران (default: false)\n\n**⚠️ توجه:**\n- نیاز به اتصال Redis دارد\n- بررسی همه کاربران ممکن است زمان‌بر باشد\n- برای بررسی سریع از `/users-without-recommendations/count` استفاده کنید\n\n**پاسخ شامل:**\n- `total_users`: تعداد کل کاربران بررسی شده\n- `users_with_recommendations`: تعداد کاربران با توصیه\n- `users_without_recommendations`: تعداد کاربران بدون توصیه\n- `user_ids_without_recommendations`: لیست شناسه کاربران بدون توصیه\n- `percentage_with_recommendations`: درصد کاربران با توصیه\n- `percentage_without_recommendations`: درصد کاربران بدون توصیه"
					},
					"response": [
						{
							"name": "Users Without Recommendations",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/users-without-recommendations?limit=100",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"users-without-recommendations"
									],
									"query": [
										{
											"key": "limit",
											"value": "100"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"total_users\": 100,\n    \"users_with_recommendations\": 75,\n    \"users_without_recommendations\": 25,\n    \"user_ids_without_recommendations\": [1234567, 2345678, 3456789],\n    \"percentage_with_recommendations\": 75.0,\n    \"percentage_without_recommendations\": 25.0\n}"
						}
					]
				},
				{
					"name": "تعداد کاربران بدون توصیه (تخمین)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/users-without-recommendations/count",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users-without-recommendations",
								"count"
							]
						},
						"description": "دریافت تعداد کاربران بدون توصیه (سریع‌تر از endpoint کامل)\n\n**⚠️ توجه:**\n- این endpoint فقط تعداد را برمی‌گرداند (تخمین)\n- برای لیست دقیق از `/users-without-recommendations` استفاده کنید\n- از نمونه‌گیری برای تخمین استفاده می‌کند\n\n**پاسخ شامل:**\n- `total_users`: تعداد کل کاربران\n- `sample_size`: اندازه نمونه\n- `users_without_in_sample`: تعداد کاربران بدون توصیه در نمونه\n- `estimated_percentage_without`: درصد تخمینی\n- `estimated_users_without_recommendations`: تعداد تخمینی"
					},
					"response": [
						{
							"name": "Count Estimate",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/users-without-recommendations/count",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"users-without-recommendations",
										"count"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"total_users\": 10000,\n    \"sample_size\": 1000,\n    \"users_without_in_sample\": 250,\n    \"estimated_percentage_without\": 25.0,\n    \"estimated_users_without_recommendations\": 2500,\n    \"note\": \"این یک تخمین است. برای لیست دقیق از /users-without-recommendations استفاده کنید\"\n}"
						}
					]
				}
			],
			"description": "Endpointهای مربوط به بررسی کاربران بدون توصیه"
		},
		{
			"name": "کاربران با توصیه - Users With Recommendations",
			"item": [
				{
					"name": "لیست کاربران با توصیه",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/users-with-recommendations?limit=100&use_redis=true&use_duckdb=true",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users-with-recommendations"
							],
							"query": [
								{
									"key": "limit",
									"value": "100",
									"description": "محدود کردن تعداد کاربران (None = همه)"
								},
								{
									"key": "use_redis",
									"value": "true",
									"description": "استفاده از Redis برای دریافت لیست (اولویت اول)"
								},
								{
									"key": "use_duckdb",
									"value": "true",
									"description": "استفاده از DuckDB برای دریافت لیست (fallback)"
								}
							]
						},
						"description": "دریافت لیست ID کاربرانی که توصیه دارند\n\n**پارامترها:**\n- `limit` (query): محدود کردن تعداد کاربران (optional)\n- `use_redis` (query): استفاده از Redis (default: true)\n- `use_duckdb` (query): استفاده از DuckDB (default: true)\n\n**ترتیب بررسی:**\n1. Redis (اولویت اول) - خواندن کلیدهای `recommendation:*`\n2. DuckDB (fallback) - اگر Redis در دسترس نباشد\n\n**⚠️ توجه:**\n- لیست user_id ها به صورت صعودی مرتب می‌شوند\n- اگر هیچ کاربری یافت نشود، خطای 404 برمی‌گرداند\n\n**پاسخ شامل:**\n- `total_users`: تعداد کل کاربران با توصیه\n- `user_ids`: لیست شناسه کاربران با توصیه\n- `source`: منبع داده (`redis` یا `duckdb`)"
					},
					"response": [
						{
							"name": "Users With Recommendations (Redis)",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/users-with-recommendations?limit=100",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"users-with-recommendations"
									],
									"query": [
										{
											"key": "limit",
											"value": "100"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"total_users\": 100,\n    \"user_ids\": [123, 456, 789, 9194445, 1234567, 2345678],\n    \"source\": \"redis\"\n}"
						},
						{
							"name": "Users With Recommendations (DuckDB)",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/users-with-recommendations?use_redis=false",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"users-with-recommendations"
									],
									"query": [
										{
											"key": "use_redis",
											"value": "false"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"total_users\": 1500,\n    \"user_ids\": [123, 456, 789, 9194445, 1234567, 2345678],\n    \"source\": \"duckdb\"\n}"
						},
						{
							"name": "Not Found (404)",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/users-with-recommendations",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"users-with-recommendations"
									]
								}
							},
							"status": "Not Found",
							"code": 404,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"detail\": \"هیچ کاربری با توصیه یافت نشد\"\n}"
						}
					]
				},
				{
					"name": "لیست کاربران با توصیه (محدود شده)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/users-with-recommendations?limit=50",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users-with-recommendations"
							],
							"query": [
								{
									"key": "limit",
									"value": "50",
									"description": "محدود کردن به 50 کاربر اول"
								}
							]
						},
						"description": "مثال: دریافت 50 کاربر اول که توصیه دارند"
					},
					"response": []
				},
				{
					"name": "فقط از DuckDB",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/users-with-recommendations?use_redis=false",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users-with-recommendations"
							],
							"query": [
								{
									"key": "use_redis",
									"value": "false",
									"description": "استفاده فقط از DuckDB"
								}
							]
						},
						"description": "مثال: دریافت لیست فقط از DuckDB (بدون Redis)"
					},
					"response": []
				}
			],
			"description": "Endpointهای مربوط به دریافت لیست کاربرانی که توصیه دارند"
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8000",
			"type": "string",
			"description": "آدرس پایه API - می‌توانید این را برای محیط‌های مختلف تغییر دهید"
		},
		{
			"key": "user_id",
			"value": "9194445",
			"type": "string",
			"description": "شناسه کاربر نمونه برای تست"
		},
		{
			"key": "product_id",
			"value": "501838",
			"type": "string",
			"description": "شناسه محصول نمونه برای تست"
		},
		{
			"key": "job_id",
			"value": "550e8400-e29b-41d4-a716-446655440000",
			"type": "string",
			"description": "شناسه job نمونه برای تست (از endpoint /generate-recommendations دریافت می‌شود)"
		}
	]
}

